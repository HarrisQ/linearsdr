---
title: "Linear SDR for scalar Y"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Linear SDR for scalar Y}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(linearsdr)
```

```{r}
library(ggplot2)

use

X = as.matrix(airfoil_datta[,1:5])
Y = c(airfoil_datta[,6])

b_hat_sir = sir(x=X, y=Y, nslices = 5, d=2, ytype = "continuous" )$beta


ggplot_fsdr(Y, t((X)%*%b_hat_sir), y_on_axis=T, ytype="continuous",
                     h_lab='SIR 1', v_lab='SIR 2',
                     main_lab= paste0('SIR'), size=3)

b_hat_dr = dr(x=X, y=Y, nslices = 5, d=2, ytype = "continuous" )$beta


ggplot_fsdr(Y, t((X)%*%b_hat_dr), y_on_axis=F, ytype="continuous",
                     h_lab='DR 1', v_lab='DR 2',
                     main_lab= paste0('DR'), size=3)




```

Forward methods using OPG
```{r}
library("doParallel")
library("foreach")

stopCluster(cl)
print( paste( as.character(detectCores()), "cores detected" ) );
# Create cluster with desired number of cores
if ( !grepl("hxq5", getwd()) ) {
  cl <- makePSOCKcluster(detectCores()-1)
} else if ( grepl("hxq5", getwd()) ) {
  cl <- parallel::makeCluster(nprocs, type=mp_type)
}

# Register cluster
doParallel::registerDoParallel(cl)
# Find out how many cores are being used
print( paste( as.character(getDoParWorkers() ), "cores registered" ) )
## [1] 3

b_hat_opg = opcg(x=X, y=Y, bw = 2, d=2, ytype = "continuous", 
                 method= "cg", parallelize = T )


ggplot_fsdr(Y, t((X)%*%b_hat_opg)[1:2,], y_on_axis=F, ytype="continuous",
                     h_lab='OPG 1', v_lab='OPG 2',
                     main_lab= paste0('DR'), size=3)

```
