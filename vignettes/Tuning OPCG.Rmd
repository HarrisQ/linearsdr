---
title: "Tuning OPCG"
author: "Harris Quach"
date: '`r Sys.Date()`'
output:
  rmarkdown::html_vignette:
    toc: true
    toc_depth: 3
    vignette: >
      %\VignetteIndexEntry{Tuning OPCG}
      %\VignetteEngine{knitr::rmarkdown}
      %\VignetteEncoding{UTF-8}
---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Tuning OPCG

We can tune the bandwidth in the Outer Product of Canonical Gradients (OPCG) using the "supervised k-means"-like approach.

  1. For a given $h$, we estimate $\hat \beta$ using some training set;
  2. Construct the sufficient predictors for the given $h$ on some tuning/validation set, denote $\hat \beta^{\top} X^{(v)}$;
  3. Pick $h$ that minimizes a k-means-like criterion;

Below is an interactive figure illustrating the methods on some synthetic data. We generate the data from five clusters that are labeled into 3 groups. By moving the slider, you will notice that the minimum of the criterion functions corresponds with very good separation of the labels. 

<iframe src="tuning_sc.html" height="600" width="850" style="border: 1px solid #464646;" allowfullscreen="" allow="autoplay" data-external="1"></iframe>






