<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="linearsdr">
<title>Linear SDR for categorical Y • linearsdr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Linear SDR for categorical Y">
<meta property="og:description" content="linearsdr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-1XP1GZGPTF"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-1XP1GZGPTF');
</script>
</head>
<body>
    <a href="#container" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a class="navbar-brand me-2" href="../index.html">linearsdr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1</small>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-2">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">Home</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/linearsdr.html">Overview to Linear SDR</a>
    <a class="dropdown-item" href="../articles/sdr_cts.html">Continuous Responses</a>
    <a class="dropdown-item" href="../articles/sdr_cat.html">Categorical Responses</a>
    <a class="dropdown-item" href="../articles/Tuning%20OPCG.html">Tuning OPCG</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions and Datasets</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../index.html">changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="https://github.com/HarrisQ/linearsdr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
  </div>
</nav><div class="container template-article" id="container">
<script src="sdr_cat_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
      <img src="" class="logo" alt=""><h1>Linear SDR for categorical Y</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/HarrisQ/linearsdr/blob/HEAD/vignettes/sdr_cat.Rmd"><code>vignettes/sdr_cat.Rmd</code></a></small>
      <div class="d-none name"><code>sdr_cat.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we demonstrate the available methods for linear Sufficient Dimension Reduction methods when working with categorical responses.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://harrisq.github.io/linearsdr/" class="external-link">linearsdr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="co">#&gt; Warning: package 'ggplot2' was built under R version 4.0.5</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"doParallel"</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: foreach</span>
<span class="co">#&gt; Loading required package: iterators</span>
<span class="co">#&gt; Loading required package: parallel</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/RevolutionAnalytics/foreach" class="external-link">"foreach"</a></span><span class="op">)</span>
<span class="co"># check number of cores available</span>
<span class="co"># print( paste( as.character(detectCores()), "cores detected" ) );</span>

<span class="co"># Create cluster with desired number of cores</span>
<span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makePSOCKcluster</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>

<span class="co"># Register cluster</span>
<span class="fu">doParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span>

<span class="co"># Find out how many cores are being used</span>
<span class="co"># print( paste( as.character(getDoParWorkers() ), "cores registered" ) )</span></code></pre></div>
<div class="section level2">
<h2 id="categorical-responses">Categorical Responses<a class="anchor" aria-label="anchor" href="#categorical-responses"></a>
</h2>
<p>We demonstrate methods for categorical data on the handwritten pen digits dataset available <a href="https://archive.ics.uci.edu/ml/datasets/Pen-Based+Recognition+of+Handwritten+Digits" class="external-link">here</a>, which consists of 16 predictors representing written features and one categorical response for the digits 0-9. We randomly sample 1000 observations from the training set and 1000 observations from the testing set. These two samples are combined into the ‘pendigits_datta’ matrix, with the first 1000 being the training and last 1000 being the testing.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'pendigits_datta'</span>, package<span class="op">=</span><span class="st">"linearsdr"</span><span class="op">)</span>

<span class="va">X1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">pendigits_datta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span><span class="op">)</span>
<span class="va">Y1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pendigits_datta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>,<span class="fl">17</span><span class="op">]</span><span class="op">)</span>

<span class="va">X1_test</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">pendigits_datta</span><span class="op">[</span><span class="fl">1001</span><span class="op">:</span><span class="fl">2000</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">16</span><span class="op">]</span><span class="op">)</span>
<span class="va">Y1_test</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pendigits_datta</span><span class="op">[</span><span class="fl">1001</span><span class="op">:</span><span class="fl">2000</span>,<span class="fl">17</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p>For Inverse methods, since the response is categorical, the number of slices are taken to be equal to the number of levels in the response. That is, we take 10 slices for SIR, SAVE and DR. For all methods, we plot the first three predictors against each other, coloring in the labels to illustrate the separation of digits.</p>
<div class="section level3">
<h3 id="sliced-inverse-regression-sir">Sliced Inverse Regression (SIR)<a class="anchor" aria-label="anchor" href="#sliced-inverse-regression-sir"></a>
</h3>
<p>For SIR, we can only recover 9 directions since we are using 10 slices, so we set <span class="math inline">\(d=9\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Sliced Inverse Regression</span>

<span class="va">b_hat_sir1</span> <span class="op">=</span> <span class="fu"><a href="../reference/sir.html">sir</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">X1</span>, y<span class="op">=</span><span class="va">Y1</span>, nslices <span class="op">=</span> <span class="fl">10</span>, d<span class="op">=</span><span class="fl">9</span>, ytype <span class="op">=</span> <span class="st">"categorical"</span> <span class="op">)</span><span class="op">$</span><span class="va">beta</span>


<span class="fu">linearsdr</span><span class="fu">:::</span><span class="fu">ggplot_fsdr</span><span class="op">(</span><span class="va">Y1_test</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">(</span><span class="va">X1_test</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">b_hat_sir1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, y_on_axis<span class="op">=</span><span class="cn">F</span>,
                        ytype<span class="op">=</span><span class="st">"multinomial"</span>,
                        h_lab<span class="op">=</span><span class="st">'SIR 1'</span>, v_lab<span class="op">=</span><span class="st">'SIR2'</span>,
                        main_lab<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'SIR'</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span>

<span class="fu">linearsdr</span><span class="fu">:::</span><span class="fu">ggplot_fsdr</span><span class="op">(</span><span class="va">Y1_test</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">(</span><span class="va">X1_test</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">b_hat_sir1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, y_on_axis<span class="op">=</span><span class="cn">F</span>,
                        ytype<span class="op">=</span><span class="st">"multinomial"</span>,
                        h_lab<span class="op">=</span><span class="st">'SIR 2'</span>, v_lab<span class="op">=</span><span class="st">'SIR3'</span>,
                        main_lab<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'SIR'</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span>

<span class="fu">linearsdr</span><span class="fu">:::</span><span class="fu">ggplot_fsdr</span><span class="op">(</span><span class="va">Y1_test</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">(</span><span class="va">X1_test</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">b_hat_sir1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, y_on_axis<span class="op">=</span><span class="cn">F</span>,
                        ytype<span class="op">=</span><span class="st">"multinomial"</span>,
                        h_lab<span class="op">=</span><span class="st">'SIR 1'</span>, v_lab<span class="op">=</span><span class="st">'SIR3'</span>,
                        main_lab<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'SIR'</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></code></pre></div>
<p><img src="sdr_cat_files/figure-html/unnamed-chunk-3-1.png" width="700"><img src="sdr_cat_files/figure-html/unnamed-chunk-3-2.png" width="700"><img src="sdr_cat_files/figure-html/unnamed-chunk-3-3.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="sliced-average-variance-estimator-save">Sliced Average Variance Estimator (SAVE)<a class="anchor" aria-label="anchor" href="#sliced-average-variance-estimator-save"></a>
</h3>
<p>For SAVE, we do not have the same constraint on <span class="math inline">\(d\)</span>, but we set it to <span class="math inline">\(9\)</span> out of convenience. It has no effect on the estimation.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Sliced Average Variance Estimator</span>

<span class="va">b_hat_save1</span> <span class="op">=</span> <span class="fu"><a href="../reference/save_sdr.html">save_sdr</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">X1</span>, y<span class="op">=</span><span class="va">Y1</span>, nslices <span class="op">=</span> <span class="fl">10</span>, d<span class="op">=</span><span class="fl">9</span>, ytype <span class="op">=</span> <span class="st">"categorical"</span> <span class="op">)</span><span class="op">$</span><span class="va">beta</span>


<span class="fu">linearsdr</span><span class="fu">:::</span><span class="fu">ggplot_fsdr</span><span class="op">(</span><span class="va">Y1_test</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">(</span><span class="va">X1_test</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">b_hat_save1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, y_on_axis<span class="op">=</span><span class="cn">F</span>,
                        ytype<span class="op">=</span><span class="st">"multinomial"</span>,
                        h_lab<span class="op">=</span><span class="st">'SAVE 1'</span>, v_lab<span class="op">=</span><span class="st">'SAVE 2'</span>,
                        main_lab<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'SAVE'</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span>

<span class="fu">linearsdr</span><span class="fu">:::</span><span class="fu">ggplot_fsdr</span><span class="op">(</span><span class="va">Y1_test</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">(</span><span class="va">X1_test</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">b_hat_save1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, y_on_axis<span class="op">=</span><span class="cn">F</span>,
                        ytype<span class="op">=</span><span class="st">"multinomial"</span>,
                        h_lab<span class="op">=</span><span class="st">'SAVE 2'</span>, v_lab<span class="op">=</span><span class="st">'SAVE 3'</span>,
                        main_lab<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'SAVE'</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span>

<span class="fu">linearsdr</span><span class="fu">:::</span><span class="fu">ggplot_fsdr</span><span class="op">(</span><span class="va">Y1_test</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">(</span><span class="va">X1_test</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">b_hat_save1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, y_on_axis<span class="op">=</span><span class="cn">F</span>,
                        ytype<span class="op">=</span><span class="st">"multinomial"</span>,
                        h_lab<span class="op">=</span><span class="st">'SAVE 1'</span>, v_lab<span class="op">=</span><span class="st">'SAVE3'</span>,
                        main_lab<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'SAVE'</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></code></pre></div>
<p><img src="sdr_cat_files/figure-html/unnamed-chunk-4-1.png" width="700"><img src="sdr_cat_files/figure-html/unnamed-chunk-4-2.png" width="700"><img src="sdr_cat_files/figure-html/unnamed-chunk-4-3.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="directional-regression-dr">Directional Regression (DR)<a class="anchor" aria-label="anchor" href="#directional-regression-dr"></a>
</h3>
<p>Similarly for DR, we do not have the same constraint on <span class="math inline">\(d\)</span>, but we set it to <span class="math inline">\(9\)</span> out of convenience. It has no effect on the estimation.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Directional Regression</span>

<span class="va">b_hat_dr1</span> <span class="op">=</span> <span class="fu"><a href="../reference/dr.html">dr</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">X1</span>, y<span class="op">=</span><span class="va">Y1</span>, nslices <span class="op">=</span> <span class="fl">10</span>, d<span class="op">=</span><span class="fl">9</span>, ytype <span class="op">=</span> <span class="st">"categorical"</span> <span class="op">)</span><span class="op">$</span><span class="va">beta</span>


<span class="fu">linearsdr</span><span class="fu">:::</span><span class="fu">ggplot_fsdr</span><span class="op">(</span><span class="va">Y1_test</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">(</span><span class="va">X1_test</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">b_hat_dr1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, y_on_axis<span class="op">=</span><span class="cn">F</span>,
                        ytype<span class="op">=</span><span class="st">"multinomial"</span>,
                        h_lab<span class="op">=</span><span class="st">'DR 1'</span>, v_lab<span class="op">=</span><span class="st">'DR 2'</span>,
                        main_lab<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'DR'</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span>

<span class="fu">linearsdr</span><span class="fu">:::</span><span class="fu">ggplot_fsdr</span><span class="op">(</span><span class="va">Y1_test</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">(</span><span class="va">X1_test</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">b_hat_dr1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, y_on_axis<span class="op">=</span><span class="cn">F</span>,
                        ytype<span class="op">=</span><span class="st">"multinomial"</span>,
                        h_lab<span class="op">=</span><span class="st">'DR 2'</span>, v_lab<span class="op">=</span><span class="st">'DR 3'</span>,
                        main_lab<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'DR'</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span>

<span class="fu">linearsdr</span><span class="fu">:::</span><span class="fu">ggplot_fsdr</span><span class="op">(</span><span class="va">Y1_test</span>, <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">(</span><span class="va">X1_test</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">b_hat_dr1</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, y_on_axis<span class="op">=</span><span class="cn">F</span>,
                        ytype<span class="op">=</span><span class="st">"multinomial"</span>,
                        h_lab<span class="op">=</span><span class="st">'DR 1'</span>, v_lab<span class="op">=</span><span class="st">'DR 3'</span>,
                        main_lab<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'DR'</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">2.5</span><span class="op">)</span></code></pre></div>
<p><img src="sdr_cat_files/figure-html/unnamed-chunk-5-1.png" width="700"><img src="sdr_cat_files/figure-html/unnamed-chunk-5-2.png" width="700"><img src="sdr_cat_files/figure-html/unnamed-chunk-5-3.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="outer-product-of-canonical-gradients-opcg">Outer Product of Canonical Gradients (OPCG)<a class="anchor" aria-label="anchor" href="#outer-product-of-canonical-gradients-opcg"></a>
</h3>
<p>For OPCG, we use a Gaussian kernel for the local linear weights and standardize the predictors so that the kernel choice is more appropriate. The bandwidth is set to <span class="math inline">\(1.42\)</span> using the Tuning method for OPCG proposed in the paper. We parallelize the computation to make OPCG relatively competitive with the inverse methods in terms of computation. For convenience, we set <span class="math inline">\(d=9\)</span>; this has no effect on the estimation. The code is not run due to the compiling speed for this site.</p>
<p><img src="../reference/figures/cat/ex1_opcg1.png"><img src="../reference/figures/cat/ex1_opcg2.png"><img src="../reference/figures/cat/ex1_opcg3.png"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># OPG Estimate </span>

 
<span class="co"># X1_std=(sapply(1:dim(X1)[2], FUN= function(j)</span>
<span class="co">#   center_cpp(X1[,j], NULL) ) )%*%matpower_cpp(cov((X1)) , -1/2);</span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co"># b_hat_opcg1 = opcg(x=X1_std, y=Y1, bw = 1.42, d=9, ytype = "cat", </span>
<span class="co">#                   method= "cg", parallelize = T )</span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co"># opcg_plot1_1=linearsdr:::ggplot_fsdr(Y1_test, t((X1_test)%*%b_hat_opcg1[,c(1,2)]),</span>
<span class="co">#                                      y_on_axis=F,</span>
<span class="co">#                                      ytype="multinomial",</span>
<span class="co">#                                      h_lab='OPCG 1', v_lab='OPCG 2',</span>
<span class="co">#                                      main_lab= paste0('OPCG'), size=2.5)</span>
<span class="co"># </span>
<span class="co"># opcg_plot1_2=linearsdr:::ggplot_fsdr(Y1_test, t((X1_test)%*%b_hat_opcg1[,c(2,3)]),</span>
<span class="co">#                                      y_on_axis=F,</span>
<span class="co">#                                       ytype="multinomial",</span>
<span class="co">#                                       h_lab='OPCG 2', v_lab='OPCG 3',</span>
<span class="co">#                                       main_lab= paste0('OPCG'), size=2.5)</span>
<span class="co"># </span>
<span class="co"># opcg_plot1_3=linearsdr:::ggplot_fsdr(Y1_test, t((X1_test)%*%b_hat_opcg1[,c(1,3)]),</span>
<span class="co">#                                      y_on_axis=F,</span>
<span class="co">#                                       ytype="multinomial",</span>
<span class="co">#                                       h_lab='OPCG 1', v_lab='OPCG 3',</span>
<span class="co">#                                       main_lab= paste0('OPCG'), size=2.5)</span>
<span class="co"># </span>
<span class="co"># linearsdr:::save_sdr_plot(opcg_plot1_2,</span>
<span class="co">#                           filename = paste0('../man/figures/cat/ex1_opcg2.png'),</span>
<span class="co">#                           width = 800, height = 450, units = "px", pointsize = 12,</span>
<span class="co">#                           bg = "white",  res = 100)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="minimum-average-variance-estimation-mave">Minimum Average Variance Estimation (MAVE)<a class="anchor" aria-label="anchor" href="#minimum-average-variance-estimation-mave"></a>
</h3>
<p>We use a Gaussian kernel for the local linear weights and standardize the predictors so that the kernel choice is more appropriate. For the starting value of the <span class="math inline">\(\beta\)</span> matrix, We use a <span class="math inline">\(p \times d\)</span> matrix with the upper <span class="math inline">\(d \times d\)</span> block being the identity. The bandwidth is set to <span class="math inline">\(1.42\)</span> and we set <span class="math inline">\(d=9\)</span> since this is the estimated dimension according to the Predictor Augmentation method.</p>
<p><img src="../reference/figures/cat/ex1_made1.png"><img src="../reference/figures/cat/ex1_made2.png"><img src="../reference/figures/cat/ex1_made3.png"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># MAVE Estimate</span>

<span class="co"># The code is commented out to speed up compiling of the documentation. </span>

<span class="co"># n=length(Y1)</span>
<span class="co"># </span>
<span class="co"># start_time1 = Sys.time();</span>
<span class="co"># B_hat_made1= made(X1, Y1, d=9, bw=1.42, lambda=0, B_mat=NULL, </span>
<span class="co">#                   ytype="cat",</span>
<span class="co">#                   method=list(opcg="cg", made="cg"), parallelize=T, r_mat=NULL,</span>
<span class="co">#                   control_list = list(print_iter=T, max_iter_made=10, max_iter=10));</span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co"># end_time1 = Sys.time(); end_time1 - start_time1;</span>
<span class="co"># </span>
<span class="co"># # [1] "2021-11-16 00:14:12 EST"</span>
<span class="co"># # [1] "MADE: euc_dist dist is" "0.343483075608127"      "1"</span>
<span class="co"># # [1] "MADE: euc_dist dist is" "0.26444545390969"       "2"</span>
<span class="co"># # [1] "MADE: euc_dist dist is" "0.216705259641036"      "3"</span>
<span class="co"># # [1] "MADE: euc_dist dist is" "0.18994894599904"       "4"</span>
<span class="co"># # [1] "MADE: euc_dist dist is" "0.153602241573158"      "5"</span>
<span class="co"># # [1] "MADE: euc_dist dist is" "0.126204506547097"      "6"</span>
<span class="co"># # [1] "MADE: euc_dist dist is" "0.117781922425232"      "7"</span>
<span class="co"># # [1] "MADE: euc_dist dist is" "0.102576841906797"      "8"</span>
<span class="co"># # [1] "MADE: euc_dist dist is" "0.0897011392715833"     "9"</span>
<span class="co"># # [1] "MADE: euc_dist dist is" "0.0813778799489298"     "10"</span>
<span class="co"># # [1] "0 - non-convergence"</span>
<span class="co"># # Time difference of 1.159333 hours on 39 cores</span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co">#  </span>
<span class="co"># </span>
<span class="co"># </span>
<span class="co"># made_plot1_1=linearsdr:::ggplot_fsdr(Y1_test, t((X1_test)%*%b_hat_made1[,c(1,2)]),</span>
<span class="co">#                                      y_on_axis=F,</span>
<span class="co">#                                      ytype="multinomial",</span>
<span class="co">#                                      h_lab='MADE 1', v_lab='MADE 2',</span>
<span class="co">#                                      main_lab= paste0('MADE'), size=2.5)</span>
<span class="co"># </span>
<span class="co"># made_plot1_2=linearsdr:::ggplot_fsdr(Y1_test, t((X1_test)%*%b_hat_made1[,c(2,3)]),</span>
<span class="co">#                                      y_on_axis=F,</span>
<span class="co">#                                       ytype="multinomial",</span>
<span class="co">#                                       h_lab='MADE 2', v_lab='MADE 3',</span>
<span class="co">#                                       main_lab= paste0('MADE'), size=2.5)</span>
<span class="co"># </span>
<span class="co"># made_plot1_3=linearsdr:::ggplot_fsdr(Y1_test, t((X1_test)%*%b_hat_made1[,c(1,3)]),</span>
<span class="co">#                                      y_on_axis=F,</span>
<span class="co">#                                       ytype="multinomial",</span>
<span class="co">#                                       h_lab='MADE 1', v_lab='MADE 3',</span>
<span class="co">#                                       main_lab= paste0('MADE'), size=2.5)</span>
<span class="co"># </span>
<span class="co"># linearsdr:::save_sdr_plot(made_plot1_3,</span>
<span class="co">#                           filename = paste0('../man/figures/cat/ex1_made3.png'),</span>
<span class="co">#                           width = 800, height = 450, units = "px", pointsize = 12,</span>
<span class="co">#                           bg = "white",  res = 100)</span></code></pre></div>
</div>
</div>
  </div>
 <div class="col-md-3" id="pkgdown-sidebar">
        <nav id="toc"><h2>On this page</h2>
    </nav>
</div>

</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://harrisq.github.io" class="external-link">Harris Quach</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
